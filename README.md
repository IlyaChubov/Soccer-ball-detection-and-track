# Soccer-ball-detection-and-track
Using yolov11 to detect and track a soccer ball

В данном ноутбуке приведено решение задачи для трекинга + детекции мяча. Для обучения выбрана модель yolov11. Было проведено 2 эксперимента, отчет по которым будет приведен ниже. В качестве обучающего набора был использован публичный набор данных SoccerNet-Gamestate, который содержит покадровую аннотацию выбранных фрагментов трансляции. Инструкции по загрузке данных
доступны в официальном репозитории. Ссылка: https://github.com/SoccerNet/sn-gamestate?tab=readme-ov-file#manual-downloading-of-soccernet-gamestate

# Отчет по качеству модели:

## Первая модель (yolo nano)

![image](https://github.com/user-attachments/assets/61e856c0-6f66-441f-b2b1-a0cb9c0d8e61)

В целом, можем наблюдать, что с каждой эпохой все метрики демонстрируют неплохой рост. Потери на валидационном наборе данных также снижаются, что позволяет нам говорить о том, что модель не переобучается и способна обобщать данные. При этом мы наблюдаем рост metrics/precision(B), metrics/recall(B) и metrics/mAP50(B), что свидетельствует о повышении качества детекции объектов. Например, metrics/mAP50(B) увеличился с 0.20252 до 0.28099, что является значительным улучшением. В силу того, что фотографий было много, аугментации не применял. Обучение шло относительно долго, поэтому было принято остановиться на 3-х эпохах. Считаю, что продолжив обучение, метрики продолжили бы расти, точность стала бы выше.

## Вторая модель (yolo medium)

![image](https://github.com/user-attachments/assets/725b29de-a523-4530-9167-e24b2b1063b6)

train/box_loss, train/cls_loss и train/dfl_loss имеют тенденцию к снижению с каждой эпохой, что указывает на улучшение обучения модели. Например, train/box_loss снизился с 3.2963 до 2.635, что свидетельствует о более точном определении границ объектов.
Несмотря на снижение потерь, метрики качества, такие как metrics/mAP50(B), остаются ниже, чем в предыдущем эксперименте, где использовалась более простая модель YOLO. На первой эпохе значение metrics/mAP50(B) составляет 0.10736, что ниже, чем даже на первом этапе предыдущего обучения (0.20252). Скорее всего, это связано с тем, что yolo medium более сложная модель и требует больше эпох для качественного обучения. В целом рост метрик заметен, поэтому продолжить обучение имеет смысл.

# Отчет по траектории движения мяча

Алгоритм трекинга мяча с использованием модели YOLO реализует подход к детекции и визуализации движения объекта на видео. Он включает в себя загрузку предварительно обученной модели YOLO и обработку видеофайла, где каждый кадр анализируется для нахождения мяча. Координаты детекций используются для отрисовки на видео треугольников, обозначающих положение мяча. Для обработки выбросов, вызванных резкими изменениями в позициях, применяется интерполяция пропущенных значений, что позволяет создать плавный трек движения. Для улучшения качества отслеживания мяча, можно попробовать изменить порог threshold (чтобы отрисовка была в пределах предыдущего положения мяча). Также можно попробовать другой способ интерполяции, чтобы сглаживание выбросов было более плавным. Пример работы модели приведен в файле: Трекинг_мяча

